# Environment Variables Setup

## Security Update: API Keys Moved to Backend

All API keys are now **server-side only** via Vercel serverless functions. Keys are never exposed to browsers.

---

## Vercel Environment Variables

Set these in your Vercel dashboard or via CLI:

### Required Variables

```bash
# TMDB API (get from https://www.themoviedb.org/settings/api)
TMDB_API_KEY=your_tmdb_v3_api_key
TMDB_READ_TOKEN=your_tmdb_v4_read_token  # Optional, v3 key is enough

# OMDB API (get from https://www.omdbapi.com/apikey.aspx)
OMDB_API_KEY=your_omdb_api_key

# Groq API (get from https://console.groq.com/keys)
GROQ_API_KEY=your_groq_api_key

# Mistral API (get from https://console.mistral.ai/)
MISTRAL_API_KEY=your_mistral_api_key

# OpenRouter API (get from https://openrouter.ai/keys)
OPENROUTER_API_KEY=your_openrouter_api_key

# Perplexity API (optional - for web search fallback)
PERPLEXITY_API_KEY=your_perplexity_api_key
```

---

## Setting Variables via Vercel CLI

```bash
# Set production variables
vercel env add TMDB_API_KEY production
vercel env add OMDB_API_KEY production
vercel env add GROQ_API_KEY production
vercel env add MISTRAL_API_KEY production
vercel env add OPENROUTER_API_KEY production

# Set preview variables (optional)
vercel env add TMDB_API_KEY preview
vercel env add OMDB_API_KEY preview
vercel env add GROQ_API_KEY preview
vercel env add MISTRAL_API_KEY preview
vercel env add OPENROUTER_API_KEY preview

# Set development variables (optional - for local Vercel dev)
vercel env add TMDB_API_KEY development
vercel env add OMDB_API_KEY development
vercel env add GROQ_API_KEY development
vercel env add MISTRAL_API_KEY development
vercel env add OPENROUTER_API_KEY development
```

---

## Setting Variables via Vercel Dashboard

1. Go to https://vercel.com/your-username/moviemonk-ai/settings/environment-variables
2. Add each variable:
   - **Key**: Variable name (e.g., `TMDB_API_KEY`)
   - **Value**: Your API key
   - **Environments**: Select `Production`, `Preview`, and `Development`
3. Click **Save**

---

## Local Development (Optional)

If running `vercel dev` locally, you can use `.env.local`:

```bash
# .env.local (DO NOT commit to git!)
TMDB_API_KEY=your_key
OMDB_API_KEY=your_key
GROQ_API_KEY=your_key
MISTRAL_API_KEY=your_key
OPENROUTER_API_KEY=your_key
```

**Important**: `.env.local` is only for local Vercel dev server. Production uses Vercel's environment variables.

---

## Verifying Setup

After setting variables:

1. **Redeploy** your app: `vercel --prod`
2. **Test** by searching for a movie
3. **Check browser Network tab** (F12):
   - ✅ You should see calls to `/api/tmdb`, `/api/omdb`, `/api/groq`
   - ✅ You should **NOT** see API keys in any requests
   - ✅ All external API calls are from Vercel servers, not your browser

---

## Migration from Old Setup

If you were using `VITE_*` variables before:

1. **Delete** all `VITE_*` variables from Vercel dashboard
2. **Remove** `.env.local` from your project (or remove `VITE_*` entries)
3. **Add** new server-side variables (without `VITE_` prefix)
4. **Redeploy**

Old variables like `VITE_TMDB_API_KEY` are no longer needed and should be removed.

---

## Security Notes

✅ **Secure**: API keys stored in Vercel's encrypted environment variables  
✅ **Never exposed**: Keys never sent to browsers or visible in Network tab  
✅ **CORS protected**: Serverless functions only accept requests from your domain  
✅ **Free**: All proxies run on Vercel's free tier (no extra cost)

---

## Troubleshooting

### "API key not configured" error

- Check that you set the variable in the correct environment (production/preview/development)
- Variable names must be **exact** (case-sensitive, no `VITE_` prefix)
- Redeploy after adding new variables

### "CORS error" in development

- Use `vercel dev` instead of `npm run dev` for local testing with serverless functions
- Or update proxy URLs in service files to point to your deployed Vercel URL

### Variables not updating

- After changing variables, **redeploy**: `vercel --prod`
- Variables are loaded at build time, not runtime
